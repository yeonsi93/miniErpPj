<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
<head>
    <meta charset="UTF-8"/>
    <title>자재 출고</title>
    <style>
        form{max-width:400px} label{display:block;margin:10px 0 4px}
        input,button{width:100%;padding:10px;box-sizing:border-box}
    </style>
</head>
<body>
<h1>자재 출고</h1>
<p><a href="/materials">← 목록</a></p>

<form onsubmit="submitRelease(event)">
    <input type="hidden" id="materialId" th:value="${materialId}">
    <label>출고 수량</label>
    <input id="quantity" type="number" min="1" step="1" required>
    <button type="submit" style="margin-top:10px">출고 처리</button>
</form>

<script>
    async function submitRelease(e){
        e.preventDefault();
        const body = {
            materialId: Number(document.getElementById('materialId').value),
            quantity: Number(document.getElementById('quantity').value)
        };
        const res = await fetch('/api/materials/release', {
            method:'POST',
            headers:{'Content-Type':'application/json'},
            body: JSON.stringify(body)
        });
        if(res.ok){ alert('출고 완료'); location.href='/materials'; }
        else{
            const msg = await res.text().catch(()=>null);
            alert('출고 실패' + (msg?`: ${msg}`:''));
        }
    }
</script>
</body>
</html>
